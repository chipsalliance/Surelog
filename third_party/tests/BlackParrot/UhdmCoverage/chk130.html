
<!DOCTYPE html>
<html>
<head>
<style>
body {

}
p {
font-size: 14px;
}</style>
<h3>./bp_be/src/v/bp_be_calculator/bp_be_calculator_top.v Cov: 89% </h3>
<pre style="margin:0; padding:0 ">   1: /**</pre>
<pre style="margin:0; padding:0 ">   2:  *</pre>
<pre style="margin:0; padding:0 ">   3:  * Name:</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">   4:  *   bp_be_calculator_top.v</pre>
<pre id="id5" style="background-color: #FFB6C1; margin:0; padding:0 ">   5:  * </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">   6:  * Description:</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">   7:  *</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">   8:  * Notes:</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">   9:  *   Should subdivide this module into a few helper modules to reduce complexity. Perhaps</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  10:  *     issuer, exe_pipe, completion_pipe, status_gen?</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  11:  *   Exception aggregation could be simplified with constants and more thought. Should fix</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  12:  *     once code is more stable, fixing in cleanup could cause regressions</pre>
<pre style="margin:0; padding:0 ">  13:  */</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  14: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  15: module bp_be_calculator_top </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  16:  import bp_common_pkg::*;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  17:  import bp_common_aviary_pkg::*;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  18:  import bp_common_rv64_pkg::*;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  19:  import bp_be_pkg::*;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  20:  #(parameter bp_cfg_e cfg_p = e_bp_inv_cfg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  21:     `declare_bp_proc_params(cfg_p)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  22:     `declare_bp_fe_be_if_widths(vaddr_width_p, paddr_width_p, asid_width_p, branch_metadata_fwd_width_p)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  23:     `declare_bp_lce_cce_if_widths(num_cce_p, num_lce_p, paddr_width_p, lce_assoc_p, dword_width_p, cce_block_width_p)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  24: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  25:    // Default parameters</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  26:    , parameter fp_en_p                  = 0</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  27: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  28:    // Generated parameters</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  29:    , localparam proc_cfg_width_lp       = `bp_proc_cfg_width(num_core_p, num_cce_p, num_lce_p)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  30:    , localparam issue_pkt_width_lp      = `bp_be_issue_pkt_width(vaddr_width_p, branch_metadata_fwd_width_p)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  31:    , localparam isd_status_width_lp     = `bp_be_isd_status_width</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  32:    , localparam calc_status_width_lp    = `bp_be_calc_status_width(vaddr_width_p, branch_metadata_fwd_width_p)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  33:    , localparam exception_width_lp      = `bp_be_exception_width</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  34:    , localparam mmu_cmd_width_lp        = `bp_be_mmu_cmd_width(vaddr_width_p)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  35:    , localparam csr_cmd_width_lp        = `bp_be_csr_cmd_width</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  36:    , localparam mem_resp_width_lp       = `bp_be_mem_resp_width(vaddr_width_p)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  37:    , localparam dispatch_pkt_width_lp   = `bp_be_dispatch_pkt_width(vaddr_width_p, branch_metadata_fwd_width_p)</pre>
<pre style="margin:0; padding:0 ">  38:    , localparam pipe_stage_reg_width_lp = `bp_be_pipe_stage_reg_width(vaddr_width_p)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  39: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  40:    // From BP BE specifications</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  41:    , localparam pipe_stage_els_lp = 5 </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  42:    , localparam ecode_dec_width_lp = `bp_be_ecode_dec_width</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  43: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  44:    // From RISC-V specifications</pre>
<pre style="margin:0; padding:0 ">  45:    , localparam reg_addr_width_lp = rv64_reg_addr_width_gp</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  46: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  47:    // Local constants</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  48:    , localparam dispatch_point_lp   = 0</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  49:    , localparam int_commit_point_lp = 3</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  50:    , localparam fp_commit_point_lp  = 4</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  51: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  52:    , localparam int_comp_idx_lp = 0</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  53:    , localparam mul_comp_idx_lp = 1</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  54:    , localparam mem_comp_idx_lp = 2</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  55:    , localparam fp_comp_idx_lp  = 3</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  56:    )</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  57:  (input                                  clk_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  58:   , input                                reset_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  59:    </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  60:   // Slow inputs   </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  61:   , input [proc_cfg_width_lp-1:0]        proc_cfg_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  62:    </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  63:   // Calculator - Checker interface   </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  64:   , input [issue_pkt_width_lp-1:0]       issue_pkt_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  65:   , input                                issue_pkt_v_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  66:   , output                               issue_pkt_ready_o</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  67:    </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  68:   , input                                chk_dispatch_v_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  69:   , input                                chk_roll_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  70:   , input                                chk_poison_iss_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  71:   , input                                chk_poison_isd_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  72:   , input                                chk_poison_ex1_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  73:   , input                                chk_poison_ex2_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  74:    </pre>
<pre id="id75" style="background-color: #FFB6C1; margin:0; padding:0 ">  75:   , output [isd_status_width_lp-1:0]     isd_status_o</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  76:   , output [calc_status_width_lp-1:0]    calc_status_o</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  77:    </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  78:   // Mem interface   </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  79:   , output [mmu_cmd_width_lp-1:0]        mmu_cmd_o</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  80:   , output                               mmu_cmd_v_o</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  81:   , input                                mmu_cmd_ready_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  82:    </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  83:   , output [csr_cmd_width_lp-1:0]        csr_cmd_o</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  84:   , output                               csr_cmd_v_o</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  85:   , input                                csr_cmd_ready_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  86: </pre>
<pre style="margin:0; padding:0 ">  87:   , input [mem_resp_width_lp-1:0]        mem_resp_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  88:   , input                                mem_resp_v_i</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  89:   , output                               mem_resp_ready_o</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  90: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  91:   // CSRs</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  92:   , output                               instret_mem3_o</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  93:   , output [vaddr_width_p-1:0]           pc_mem3_o</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  94:   , output [instr_width_p-1:0]          instr_mem3_o</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  95:   , output                               pc_v_mem3_o</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  96:   );</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  97: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  98: // Declare parameterizable structs</pre>
<pre id="id99" style="background-color: #FFB6C1; margin:0; padding:0 ">  99: `declare_bp_be_mmu_structs(vaddr_width_p, ppn_width_p, lce_sets_p, cce_block_width_p / 8)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 100: `declare_bp_common_proc_cfg_s(num_core_p, num_cce_p, num_lce_p)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 101: `declare_bp_be_internal_if_structs(vaddr_width_p, paddr_width_p, asid_width_p, branch_metadata_fwd_width_p);</pre>
<pre style="margin:0; padding:0 "> 102: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 103: // Cast input and output ports </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 104: bp_be_issue_pkt_s   issue_pkt;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 105: bp_be_isd_status_s  isd_status;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 106: bp_be_calc_status_s calc_status;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 107: bp_be_mem_resp_s    mem_resp;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 108: bp_proc_cfg_s       proc_cfg;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 109: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 110: assign issue_pkt = issue_pkt_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 111: assign mem_resp = mem_resp_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 112: assign proc_cfg = proc_cfg_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 113: assign calc_status_o = calc_status;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 114: assign isd_status_o = isd_status;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 115: </pre>
<pre id="id116" style="background-color: #FFB6C1; margin:0; padding:0 "> 116: // Declare intermediate signals</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 117: logic                   chk_poison_iss_r;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 118: bp_be_issue_pkt_s       issue_pkt_r;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 119: logic                   issue_pkt_v_r;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 120: bp_be_dispatch_pkt_s    dispatch_pkt, dispatch_pkt_r;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 121: logic                   dispatch_pkt_v_r;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 122: bp_be_decode_s          decoded;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 123: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 124: // Register bypass network</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 125: logic [dword_width_p-1:0] irf_rs1    , irf_rs2;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 126: logic [dword_width_p-1:0] frf_rs1    , frf_rs2;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 127: logic [dword_width_p-1:0] bypass_irs1, bypass_irs2;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 128: logic [dword_width_p-1:0] bypass_frs1, bypass_frs2;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 129: logic [dword_width_p-1:0] bypass_rs1 , bypass_rs2;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 130: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 131: // Exception signals</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 132: logic load_misaligned_mem1, store_misaligned_mem3;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 133: </pre>
<pre style="margin:0; padding:0 "> 134: // Pipeline stage registers</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 135: bp_be_pipe_stage_reg_s [pipe_stage_els_lp-1:0] calc_stage_r;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 136: bp_be_pipe_stage_reg_s                         calc_stage_isd;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 137: bp_be_exception_s      [pipe_stage_els_lp-1:0] exc_stage_r;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 138: bp_be_exception_s      [pipe_stage_els_lp  :0] exc_stage_n;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 139: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 140: logic [pipe_stage_els_lp-1:0][dword_width_p-1:0] comp_stage_r, comp_stage_n;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 141: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 142: logic [dword_width_p-1:0] pipe_nop_data_lo;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 143: logic [dword_width_p-1:0] pipe_int_data_lo, pipe_mul_data_lo, pipe_mem_data_lo, pipe_fp_data_lo;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 144: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 145: logic nop_pipe_result_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 146: logic pipe_int_data_lo_v, pipe_mul_data_lo_v, pipe_mem_data_lo_v, pipe_fp_data_lo_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 147: logic pipe_mem_exc_v_lo, pipe_mem_miss_v_lo;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 148: </pre>
<pre id="id149" style="background-color: #FFB6C1; margin:0; padding:0 "> 149: logic [vaddr_width_p-1:0] br_tgt_int1;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 150: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 151: // Forwarding information</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 152: logic [pipe_stage_els_lp-1:1]                        comp_stage_n_slice_iwb_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 153: logic [pipe_stage_els_lp-1:1]                        comp_stage_n_slice_fwb_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 154: logic [pipe_stage_els_lp-1:1][reg_addr_width_lp-1:0] comp_stage_n_slice_rd_addr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 155: logic [pipe_stage_els_lp-1:1][dword_width_p-1:0] comp_stage_n_slice_rd;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 156: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 157: // Handshakes</pre>
<pre id="id158" style="background-color: #FFB6C1; margin:0; padding:0 "> 158: assign issue_pkt_ready_o = (chk_dispatch_v_i | ~issue_pkt_v_r);</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 159: </pre>
<pre style="margin:0; padding:0 "> 160: // Module instantiations</pre>
<pre style="margin:0; padding:0 "> 161: // Register files</pre>
<pre style="margin:0; padding:0 "> 162: bp_be_regfile</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 163: #(.cfg_p(cfg_p))</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 164:  int_regfile</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 165:   (.clk_i(clk_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 166:    ,.reset_i(reset_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 167: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 168:    ,.issue_v_i(issue_pkt_v_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 169:    ,.dispatch_v_i(chk_dispatch_v_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 170: </pre>
<pre style="margin:0; padding:0 "> 171:    ,.rd_w_v_i(calc_stage_r[int_commit_point_lp].irf_w_v & ~exc_stage_r[int_commit_point_lp].poison_v)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 172:    ,.rd_addr_i(calc_stage_r[int_commit_point_lp].instr.fields.rtype.rd_addr)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 173:    ,.rd_data_i(comp_stage_r[int_commit_point_lp])</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 174: </pre>
<pre style="margin:0; padding:0 "> 175:    ,.rs1_r_v_i(issue_pkt.irs1_v)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 176:    ,.rs1_addr_i(issue_pkt.instr.fields.rtype.rs1_addr)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 177:    ,.rs1_data_o(irf_rs1)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 178: </pre>
<pre style="margin:0; padding:0 "> 179:    ,.rs2_r_v_i(issue_pkt.irs2_v)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 180:    ,.rs2_addr_i(issue_pkt.instr.fields.rtype.rs2_addr)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 181:    ,.rs2_data_o(irf_rs2)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 182:    );</pre>
<pre id="id183" style="background-color: #FFB6C1; margin:0; padding:0 "> 183: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 184: if (fp_en_p)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 185:   begin : fp_rf</pre>
<pre id="id186" style="background-color: #FFB6C1; margin:0; padding:0 "> 186:     bp_be_regfile</pre>
<pre id="id187" style="background-color: #FFB6C1; margin:0; padding:0 "> 187:     #(.cfg_p(cfg_p))</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 188:      float_regfile</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 189:       (.clk_i(clk_i)</pre>
<pre id="id190" style="background-color: #FFB6C1; margin:0; padding:0 "> 190:        ,.reset_i(reset_i)</pre>
<pre id="id191" style="background-color: #FFB6C1; margin:0; padding:0 "> 191:     </pre>
<pre style="margin:0; padding:0 "> 192:        ,.issue_v_i(issue_pkt_v_i)</pre>
<pre id="id193" style="background-color: #FFB6C1; margin:0; padding:0 "> 193:        ,.dispatch_v_i(chk_dispatch_v_i)</pre>
<pre id="id194" style="background-color: #FFB6C1; margin:0; padding:0 "> 194:     </pre>
<pre style="margin:0; padding:0 "> 195:        ,.rd_w_v_i(calc_stage_r[fp_commit_point_lp].frf_w_v & ~exc_stage_r[fp_commit_point_lp].poison_v)</pre>
<pre id="id196" style="background-color: #FFB6C1; margin:0; padding:0 "> 196:        ,.rd_addr_i(calc_stage_r[fp_commit_point_lp].rd_addr)</pre>
<pre id="id197" style="background-color: #FFB6C1; margin:0; padding:0 "> 197:        ,.rd_data_i(comp_stage_r[fp_commit_point_lp])</pre>
<pre id="id198" style="background-color: #FFB6C1; margin:0; padding:0 "> 198:     </pre>
<pre style="margin:0; padding:0 "> 199:        ,.rs1_r_v_i(issue_pkt.frs1_v)</pre>
<pre id="id200" style="background-color: #FFB6C1; margin:0; padding:0 "> 200:        ,.rs1_addr_i(issue_pkt.instr.fields.rtype.rs1_addr)</pre>
<pre id="id201" style="background-color: #FFB6C1; margin:0; padding:0 "> 201:        ,.rs1_data_o(frf_rs1)</pre>
<pre id="id202" style="background-color: #FFB6C1; margin:0; padding:0 "> 202:     </pre>
<pre style="margin:0; padding:0 "> 203:        ,.rs2_r_v_i(issue_pkt.frs2_v)</pre>
<pre id="id204" style="background-color: #FFB6C1; margin:0; padding:0 "> 204:        ,.rs2_addr_i(issue_pkt.instr.fields.rtype.rs2_addr)</pre>
<pre id="id205" style="background-color: #FFB6C1; margin:0; padding:0 "> 205:        ,.rs2_data_o(frf_rs2)</pre>
<pre id="id206" style="background-color: #FFB6C1; margin:0; padding:0 "> 206:        );</pre>
<pre style="margin:0; padding:0 "> 207: </pre>
<pre style="margin:0; padding:0 "> 208:     bp_be_bypass </pre>
<pre id="id209" style="background-color: #FFB6C1; margin:0; padding:0 "> 209:      // Don't need to forward isd data</pre>
<pre style="margin:0; padding:0 "> 210:      #(.fwd_els_p(pipe_stage_els_lp-1))</pre>
<pre id="id211" style="background-color: #FFB6C1; margin:0; padding:0 "> 211:      fp_bypass</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 212:       (.id_rs1_addr_i(issue_pkt_r.instr.fields.rtype.rs1_addr)</pre>
<pre id="id213" style="background-color: #FFB6C1; margin:0; padding:0 "> 213:        ,.id_rs1_i(frf_rs1)</pre>
<pre id="id214" style="background-color: #FFB6C1; margin:0; padding:0 "> 214:     </pre>
<pre style="margin:0; padding:0 "> 215:        ,.id_rs2_addr_i(issue_pkt_r.instr.fields.rtype.rs2_addr)</pre>
<pre id="id216" style="background-color: #FFB6C1; margin:0; padding:0 "> 216:        ,.id_rs2_i(frf_rs2)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 217:     </pre>
<pre style="margin:0; padding:0 "> 218:        ,.fwd_rd_v_i(comp_stage_n_slice_fwb_v)</pre>
<pre id="id219" style="background-color: #FFB6C1; margin:0; padding:0 "> 219:        ,.fwd_rd_addr_i(comp_stage_n_slice_rd_addr)</pre>
<pre id="id220" style="background-color: #FFB6C1; margin:0; padding:0 "> 220:        ,.fwd_rd_i(comp_stage_n_slice_rd)</pre>
<pre id="id221" style="background-color: #FFB6C1; margin:0; padding:0 "> 221:     </pre>
<pre style="margin:0; padding:0 "> 222:        ,.bypass_rs1_o(bypass_frs1)</pre>
<pre id="id223" style="background-color: #FFB6C1; margin:0; padding:0 "> 223:        ,.bypass_rs2_o(bypass_frs2)</pre>
<pre id="id224" style="background-color: #FFB6C1; margin:0; padding:0 "> 224:        );</pre>
<pre style="margin:0; padding:0 "> 225:     </pre>
<pre style="margin:0; padding:0 "> 226:     bsg_mux </pre>
<pre id="id227" style="background-color: #FFB6C1; margin:0; padding:0 "> 227:      #(.width_p(dword_width_p)</pre>
<pre id="id228" style="background-color: #FFB6C1; margin:0; padding:0 "> 228:        ,.els_p(2)</pre>
<pre id="id229" style="background-color: #FFB6C1; margin:0; padding:0 "> 229:        ) </pre>
<pre style="margin:0; padding:0 "> 230:      bypass_xrs1_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 231:       (.data_i({bypass_frs1, bypass_irs1})</pre>
<pre id="id232" style="background-color: #FFB6C1; margin:0; padding:0 "> 232:        ,.sel_i(issue_pkt_r.frs1_v)</pre>
<pre id="id233" style="background-color: #FFB6C1; margin:0; padding:0 "> 233:        ,.data_o(bypass_rs1)</pre>
<pre id="id234" style="background-color: #FFB6C1; margin:0; padding:0 "> 234:        );</pre>
<pre style="margin:0; padding:0 "> 235:     </pre>
<pre style="margin:0; padding:0 "> 236:     bsg_mux </pre>
<pre id="id237" style="background-color: #FFB6C1; margin:0; padding:0 "> 237:      #(.width_p(dword_width_p)</pre>
<pre id="id238" style="background-color: #FFB6C1; margin:0; padding:0 "> 238:        ,.els_p(2)</pre>
<pre id="id239" style="background-color: #FFB6C1; margin:0; padding:0 "> 239:        ) </pre>
<pre style="margin:0; padding:0 "> 240:      bypass_xrs2_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 241:       (.data_i({bypass_frs2, bypass_irs2})</pre>
<pre id="id242" style="background-color: #FFB6C1; margin:0; padding:0 "> 242:        ,.sel_i(issue_pkt_r.frs2_v)</pre>
<pre id="id243" style="background-color: #FFB6C1; margin:0; padding:0 "> 243:        ,.data_o(bypass_rs2)</pre>
<pre id="id244" style="background-color: #FFB6C1; margin:0; padding:0 "> 244:        );</pre>
<pre style="margin:0; padding:0 "> 245:   end</pre>
<pre style="margin:0; padding:0 "> 246: else</pre>
<pre style="margin:0; padding:0 "> 247:   begin : no_fp_rf</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 248:     assign frf_rs1 = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 249:     assign frf_rs2 = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 250: </pre>
<pre style="margin:0; padding:0 "> 251:     assign bypass_frs1 = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 252:     assign bypass_frs2 = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 253: </pre>
<pre style="margin:0; padding:0 "> 254:     assign bypass_rs1 = bypass_irs1;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 255:     assign bypass_rs2 = bypass_irs2;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 256:   end</pre>
<pre style="margin:0; padding:0 "> 257: </pre>
<pre style="margin:0; padding:0 "> 258: // Issued instruction register</pre>
<pre style="margin:0; padding:0 "> 259: bsg_dff_reset_en </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 260:  #(.width_p(1+issue_pkt_width_lp))</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 261:  issue_reg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 262:   (.clk_i(clk_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 263:    ,.reset_i(reset_i | chk_roll_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 264:    ,.en_i(issue_pkt_v_i | chk_dispatch_v_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 265: </pre>
<pre style="margin:0; padding:0 "> 266:    ,.data_i({issue_pkt_v_i, issue_pkt})</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 267:    ,.data_o({issue_pkt_v_r, issue_pkt_r})</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 268:    );</pre>
<pre style="margin:0; padding:0 "> 269:    </pre>
<pre style="margin:0; padding:0 "> 270: // Register the issue poison</pre>
<pre style="margin:0; padding:0 "> 271: bsg_dff_reset_en </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 272:  #(.width_p(1))</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 273:  issue_psn_reg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 274:   (.clk_i(clk_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 275:    ,.reset_i(reset_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 276:    ,.en_i(issue_pkt_v_i | chk_dispatch_v_i | chk_poison_iss_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 277: </pre>
<pre style="margin:0; padding:0 "> 278:    ,.data_i(chk_poison_iss_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 279:    ,.data_o(chk_poison_iss_r)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 280:    );</pre>
<pre style="margin:0; padding:0 "> 281: </pre>
<pre style="margin:0; padding:0 "> 282: // Decode the dispatched instruction</pre>
<pre style="margin:0; padding:0 "> 283: logic                  fe_exc_not_instr_isd;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 284: bp_fe_exception_code_e fe_exc_isd;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 285: // Decode the dispatched instruction</pre>
<pre style="margin:0; padding:0 "> 286: bp_be_instr_decoder</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 287:  instr_decoder</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 288:   (.instr_v_i(issue_pkt_v_r)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 289:    ,.instr_i(issue_pkt_r.instr)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 290:    ,.fe_exc_not_instr_i(issue_pkt_r.fe_exception_not_instr)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 291:    ,.fe_exc_i(issue_pkt_r.fe_exception_code)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 292: </pre>
<pre style="margin:0; padding:0 "> 293:    ,.decode_o(decoded)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 294:    );</pre>
<pre style="margin:0; padding:0 "> 295: </pre>
<pre style="margin:0; padding:0 "> 296: // Bypass the instruction operands from written registers in the stack</pre>
<pre style="margin:0; padding:0 "> 297: bp_be_bypass </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 298:  // Don't need to forward isd data</pre>
<pre style="margin:0; padding:0 "> 299:  #(.fwd_els_p(pipe_stage_els_lp-1))</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 300:  int_bypass </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 301:   (.id_rs1_addr_i(issue_pkt_r.instr.fields.rtype.rs1_addr)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 302:    ,.id_rs1_i(irf_rs1)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 303: </pre>
<pre style="margin:0; padding:0 "> 304:    ,.id_rs2_addr_i(issue_pkt_r.instr.fields.rtype.rs2_addr)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 305:    ,.id_rs2_i(irf_rs2)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 306: </pre>
<pre id="id307" style="background-color: #FFB6C1; margin:0; padding:0 "> 307:    ,.fwd_rd_v_i(comp_stage_n_slice_iwb_v)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 308:    ,.fwd_rd_addr_i(comp_stage_n_slice_rd_addr)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 309:    ,.fwd_rd_i(comp_stage_n_slice_rd)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 310: </pre>
<pre id="id311" style="background-color: #FFB6C1; margin:0; padding:0 "> 311:    ,.bypass_rs1_o(bypass_irs1)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 312:    ,.bypass_rs2_o(bypass_irs2)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 313:    );</pre>
<pre style="margin:0; padding:0 "> 314: </pre>
<pre style="margin:0; padding:0 "> 315: // Computation pipelines</pre>
<pre style="margin:0; padding:0 "> 316: // Integer pipe: 1 cycle latency</pre>
<pre style="margin:0; padding:0 "> 317: bp_be_pipe_int </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 318:  #(.vaddr_width_p(vaddr_width_p))</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 319:  pipe_int</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 320:   (.clk_i(clk_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 321:    ,.reset_i(reset_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 322:  </pre>
<pre id="id323" style="background-color: #FFB6C1; margin:0; padding:0 "> 323:    ,.kill_ex1_i(exc_stage_n[1].poison_v)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 324: </pre>
<pre id="id325" style="background-color: #FFB6C1; margin:0; padding:0 "> 325:    ,.decode_i(dispatch_pkt_r.decode)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 326:    ,.pc_i(dispatch_pkt_r.pc)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 327:    ,.rs1_i(dispatch_pkt_r.rs1)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 328:    ,.rs2_i(dispatch_pkt_r.rs2)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 329:    ,.imm_i(dispatch_pkt_r.imm)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 330: </pre>
<pre style="margin:0; padding:0 "> 331:    ,.data_o(pipe_int_data_lo)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 332:    </pre>
<pre style="margin:0; padding:0 "> 333:    ,.br_tgt_o(br_tgt_int1)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 334:    );</pre>
<pre style="margin:0; padding:0 "> 335: </pre>
<pre style="margin:0; padding:0 "> 336: // Multiplication pipe: 2 cycle latency</pre>
<pre style="margin:0; padding:0 "> 337: bp_be_pipe_mul</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 338:  pipe_mul</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 339:   (.clk_i(clk_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 340:    ,.reset_i(reset_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 341: </pre>
<pre id="id342" style="background-color: #FFB6C1; margin:0; padding:0 "> 342:    ,.kill_ex1_i(exc_stage_n[1].poison_v)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 343:    ,.kill_ex2_i(exc_stage_n[2].poison_v)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 344: </pre>
<pre style="margin:0; padding:0 "> 345:    ,.decode_i(dispatch_pkt_r.decode)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 346:    ,.rs1_i(dispatch_pkt_r.rs1)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 347:    ,.rs2_i(dispatch_pkt_r.rs2)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 348: </pre>
<pre style="margin:0; padding:0 "> 349:    ,.data_o(pipe_mul_data_lo)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 350:    );</pre>
<pre style="margin:0; padding:0 "> 351: </pre>
<pre style="margin:0; padding:0 "> 352: // Memory pipe: 3 cycle latency</pre>
<pre style="margin:0; padding:0 "> 353: bp_be_pipe_mem</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 354:  #(.cfg_p(cfg_p))</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 355:  pipe_mem</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 356:   (.clk_i(clk_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 357:    ,.reset_i(reset_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 358: </pre>
<pre style="margin:0; padding:0 "> 359:    ,.kill_ex1_i(exc_stage_n[1].poison_v)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 360:    ,.kill_ex2_i(exc_stage_n[2].poison_v)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 361:    ,.kill_ex3_i(exc_stage_r[2].poison_v) </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 362: </pre>
<pre style="margin:0; padding:0 "> 363:    ,.decode_i(dispatch_pkt_r.decode)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 364:    ,.pc_i(dispatch_pkt_r.pc)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 365:    ,.instr_i(dispatch_pkt_r.instr)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 366:    ,.rs1_i(dispatch_pkt_r.rs1)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 367:    ,.rs2_i(dispatch_pkt_r.rs2)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 368:    ,.imm_i(dispatch_pkt_r.imm)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 369: </pre>
<pre style="margin:0; padding:0 "> 370:    ,.mmu_cmd_o(mmu_cmd_o)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 371:    ,.mmu_cmd_v_o(mmu_cmd_v_o)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 372:    ,.mmu_cmd_ready_i(mmu_cmd_ready_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 373: </pre>
<pre style="margin:0; padding:0 "> 374:    ,.csr_cmd_o(csr_cmd_o)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 375:    ,.csr_cmd_v_o(csr_cmd_v_o)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 376:    ,.csr_cmd_ready_i(csr_cmd_ready_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 377: </pre>
<pre style="margin:0; padding:0 "> 378:    ,.mem_resp_i(mem_resp_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 379:    ,.mem_resp_v_i(mem_resp_v_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 380:    ,.mem_resp_ready_o(mem_resp_ready_o)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 381: </pre>
<pre style="margin:0; padding:0 "> 382:    ,.exc_v_o(pipe_mem_exc_v_lo)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 383:    ,.miss_v_o(pipe_mem_miss_v_lo)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 384:    ,.data_o(pipe_mem_data_lo)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 385:    );</pre>
<pre style="margin:0; padding:0 "> 386: </pre>
<pre style="margin:0; padding:0 "> 387:   // Floating point pipe: 4 cycle latency</pre>
<pre style="margin:0; padding:0 "> 388:   bp_be_pipe_fp </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 389:    pipe_fp</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 390:     (.clk_i(clk_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 391:      ,.reset_i(reset_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 392:   </pre>
<pre style="margin:0; padding:0 "> 393:      ,.kill_ex1_i(exc_stage_n[1].poison_v)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 394:      ,.kill_ex2_i(exc_stage_n[2].poison_v)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 395:      ,.kill_ex3_i(exc_stage_n[3].poison_v) </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 396:      ,.kill_ex4_i(exc_stage_n[4].poison_v) </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 397:   </pre>
<pre style="margin:0; padding:0 "> 398:      ,.decode_i(dispatch_pkt_r.decode)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 399:      ,.rs1_i(dispatch_pkt_r.rs1)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 400:      ,.rs2_i(dispatch_pkt_r.rs2)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 401:   </pre>
<pre style="margin:0; padding:0 "> 402:      ,.data_o(pipe_fp_data_lo)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 403:      );</pre>
<pre style="margin:0; padding:0 "> 404: </pre>
<pre style="margin:0; padding:0 "> 405: // Execution pipelines</pre>
<pre style="margin:0; padding:0 "> 406: // Shift in dispatch pkt and move everything else down the pipe</pre>
<pre style="margin:0; padding:0 "> 407: bsg_dff</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 408:  #(.width_p(pipe_stage_reg_width_lp*pipe_stage_els_lp))</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 409:  calc_stage_reg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 410:   (.clk_i(clk_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 411:    ,.data_i({calc_stage_r[0+:pipe_stage_els_lp-1], calc_stage_isd})</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 412:    ,.data_o(calc_stage_r)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 413:    );</pre>
<pre style="margin:0; padding:0 "> 414: </pre>
<pre style="margin:0; padding:0 "> 415: bsg_dff</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 416:  #(.width_p(1+dispatch_pkt_width_lp))</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 417:  dispatch_pkt_reg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 418:   (.clk_i(clk_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 419:    ,.data_i({(issue_pkt_v_r & chk_dispatch_v_i), dispatch_pkt})</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 420:    ,.data_o({dispatch_pkt_v_r, dispatch_pkt_r})</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 421:    );</pre>
<pre style="margin:0; padding:0 "> 422: </pre>
<pre style="margin:0; padding:0 "> 423: // If a pipeline has completed an instruction (pipe_xxx_v), then mux in the calculated result.</pre>
<pre style="margin:0; padding:0 "> 424: // Else, mux in the previous stage of the completion pipe. Since we are single issue and have</pre>
<pre style="margin:0; padding:0 "> 425: //   static latencies, we cannot have two pipelines complete at the same time.</pre>
<pre style="margin:0; padding:0 "> 426: assign pipe_fp_data_lo_v  = calc_stage_r[3].pipe_fp_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 427: assign pipe_mem_data_lo_v = calc_stage_r[2].pipe_mem_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 428: assign pipe_mul_data_lo_v = calc_stage_r[1].pipe_mul_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 429: assign pipe_int_data_lo_v = calc_stage_r[0].pipe_int_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 430: </pre>
<pre style="margin:0; padding:0 "> 431: assign pipe_nop_data_lo = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 432: </pre>
<pre style="margin:0; padding:0 "> 433: logic [pipe_stage_els_lp-1:0][dword_width_p-1:0] comp_stage_mux_li;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 434: logic [pipe_stage_els_lp-1:0]                        comp_stage_mux_sel_li;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 435: </pre>
<pre style="margin:0; padding:0 "> 436: assign comp_stage_mux_li = {pipe_fp_data_lo, pipe_mem_data_lo, pipe_mul_data_lo, pipe_int_data_lo, pipe_nop_data_lo};</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 437: assign comp_stage_mux_sel_li = {pipe_fp_data_lo_v, pipe_mem_data_lo_v, pipe_mul_data_lo_v, pipe_int_data_lo_v, 1'b1};</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 438: bsg_mux_segmented </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 439:  #(.segments_p(pipe_stage_els_lp)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 440:    ,.segment_width_p(dword_width_p)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 441:    ) </pre>
<pre style="margin:0; padding:0 "> 442:  comp_stage_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 443:   (.data0_i({comp_stage_r[0+:pipe_stage_els_lp-1], dword_width_p'(0)})</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 444:    ,.data1_i(comp_stage_mux_li)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 445:    ,.sel_i(comp_stage_mux_sel_li)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 446:    ,.data_o(comp_stage_n)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 447:    );</pre>
<pre style="margin:0; padding:0 "> 448: </pre>
<pre style="margin:0; padding:0 "> 449: bsg_dff </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 450:  #(.width_p(dword_width_p*pipe_stage_els_lp)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 451:    ) </pre>
<pre style="margin:0; padding:0 "> 452:  comp_stage_reg </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 453:   (.clk_i(clk_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 454:    ,.data_i(comp_stage_n)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 455:    ,.data_o(comp_stage_r)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 456:    );</pre>
<pre style="margin:0; padding:0 "> 457: </pre>
<pre style="margin:0; padding:0 "> 458: // Exception pipeline</pre>
<pre style="margin:0; padding:0 "> 459: bsg_dff </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 460:  #(.width_p(exception_width_lp*pipe_stage_els_lp)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 461:    ) </pre>
<pre style="margin:0; padding:0 "> 462:  exc_stage_reg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 463:   (.clk_i(clk_i)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 464:    ,.data_i(exc_stage_n[0+:pipe_stage_els_lp])</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 465:    ,.data_o(exc_stage_r)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 466:    );</pre>
<pre style="margin:0; padding:0 "> 467: </pre>
<pre style="margin:0; padding:0 "> 468: wire fe_nop_v = chk_dispatch_v_i & ~issue_pkt_v_r;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 469: wire be_nop_v = ~chk_dispatch_v_i &  mmu_cmd_ready_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 470: wire me_nop_v = ~chk_dispatch_v_i & ~mmu_cmd_ready_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 471: </pre>
<pre style="margin:0; padding:0 "> 472: always_comb </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 473:   begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 474:     // Form dispatch packet</pre>
<pre style="margin:0; padding:0 "> 475:     dispatch_pkt.pc                  = issue_pkt_r.pc;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 476:     dispatch_pkt.branch_metadata_fwd = issue_pkt_r.branch_metadata_fwd;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 477:     dispatch_pkt.instr               = issue_pkt_r.instr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 478:     dispatch_pkt.rs1                 = bypass_rs1;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 479:     dispatch_pkt.rs2                 = bypass_rs2;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 480:     dispatch_pkt.imm                 = issue_pkt_r.imm;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 481: </pre>
<pre style="margin:0; padding:0 "> 482:       if (fe_nop_v) dispatch_pkt = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 483:       else if (be_nop_v) dispatch_pkt = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 484:       else if (me_nop_v) dispatch_pkt = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 485:       else               dispatch_pkt.decode = decoded;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 486: </pre>
<pre style="margin:0; padding:0 "> 487:     // Strip out elements of the dispatch packet that we want to save for later</pre>
<pre style="margin:0; padding:0 "> 488:     calc_stage_isd.pc             = dispatch_pkt.pc;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 489:     calc_stage_isd.instr          = dispatch_pkt.instr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 490:     calc_stage_isd.v              = dispatch_pkt.decode.v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 491:     calc_stage_isd.instr_v        = dispatch_pkt.decode.instr_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 492:     calc_stage_isd.pipe_int_v     = dispatch_pkt.decode.pipe_int_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 493:     calc_stage_isd.pipe_mul_v     = dispatch_pkt.decode.pipe_mul_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 494:     calc_stage_isd.pipe_mem_v     = dispatch_pkt.decode.pipe_mem_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 495:     calc_stage_isd.pipe_fp_v      = dispatch_pkt.decode.pipe_fp_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 496:     calc_stage_isd.mem_v          = dispatch_pkt.decode.mem_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 497:     calc_stage_isd.csr_v          = dispatch_pkt.decode.csr_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 498:     calc_stage_isd.irf_w_v        = dispatch_pkt.decode.irf_w_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 499:     calc_stage_isd.frf_w_v        = dispatch_pkt.decode.frf_w_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 500: </pre>
<pre style="margin:0; padding:0 "> 501:     // Calculator status ISD stage</pre>
<pre style="margin:0; padding:0 "> 502:     isd_status.isd_fence_v  = issue_pkt_v_r & issue_pkt_r.fence_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 503:     isd_status.isd_mem_v    = issue_pkt_v_r & issue_pkt_r.mem_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 504:     isd_status.isd_irs1_v   = issue_pkt_v_r & issue_pkt_r.irs1_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 505:     isd_status.isd_frs1_v   = issue_pkt_v_r & issue_pkt_r.frs1_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 506:     isd_status.isd_rs1_addr = issue_pkt_r.instr.fields.rtype.rs1_addr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 507:     isd_status.isd_irs2_v   = issue_pkt_v_r & issue_pkt_r.irs2_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 508:     isd_status.isd_frs2_v   = issue_pkt_v_r & issue_pkt_r.frs2_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 509:     isd_status.isd_rs2_addr = issue_pkt_r.instr.fields.rtype.rs2_addr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 510: </pre>
<pre style="margin:0; padding:0 "> 511:     // Calculator status EX1 information</pre>
<pre style="margin:0; padding:0 "> 512:     calc_status.int1_v                   = dispatch_pkt_r.decode.pipe_int_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 513:     calc_status.int1_br_tgt              = br_tgt_int1;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 514:     calc_status.int1_branch_metadata_fwd = dispatch_pkt_r.branch_metadata_fwd;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 515:     calc_status.int1_btaken              = (dispatch_pkt_r.decode.br_v & pipe_int_data_lo[0])</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 516:                                            | dispatch_pkt_r.decode.jmp_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 517:     calc_status.int1_br_or_jmp           = dispatch_pkt_r.decode.br_v </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 518:                                            | dispatch_pkt_r.decode.jmp_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 519:     calc_status.ex1_v                    = dispatch_pkt_r.decode.v & ~exc_stage_r[0].poison_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 520:     calc_status.ex1_pc                   = dispatch_pkt_r.pc;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 521:     calc_status.ex1_instr_v              = dispatch_pkt_r.decode.instr_v & ~exc_stage_r[0].poison_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 522:     calc_status.mem1_fencei_v            = dispatch_pkt_r.decode.fencei_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 523: </pre>
<pre style="margin:0; padding:0 "> 524:     // Dependency information for pipelines</pre>
<pre style="margin:0; padding:0 "> 525:     for (integer i = 0; i < pipe_stage_els_lp; i++) </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 526:       begin : dep_status</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 527:         calc_status.dep_status[i].int_iwb_v = calc_stage_r[i].pipe_int_v </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 528:                                               & ~exc_stage_n[i+1].poison_v</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 529:                                               & calc_stage_r[i].irf_w_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 530:         calc_status.dep_status[i].mul_iwb_v = calc_stage_r[i].pipe_mul_v </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 531:                                               & ~exc_stage_n[i+1].poison_v</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 532:                                               & calc_stage_r[i].irf_w_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 533:         calc_status.dep_status[i].mem_iwb_v = calc_stage_r[i].pipe_mem_v </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 534:                                               & ~exc_stage_n[i+1].poison_v</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 535:                                               & calc_stage_r[i].irf_w_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 536:         calc_status.dep_status[i].mem_fwb_v = calc_stage_r[i].pipe_mem_v </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 537:                                               & ~exc_stage_n[i+1].poison_v</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 538:                                               & calc_stage_r[i].frf_w_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 539:         calc_status.dep_status[i].fp_fwb_v  = calc_stage_r[i].pipe_fp_v  </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 540:                                               & ~exc_stage_n[i+1].poison_v</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 541:                                               & calc_stage_r[i].frf_w_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 542:         calc_status.dep_status[i].rd_addr   = calc_stage_r[i].instr.fields.rtype.rd_addr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 543:         calc_status.dep_status[i].mem_v     = calc_stage_r[i].mem_v & ~exc_stage_n[i+1].poison_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 544:         calc_status.dep_status[i].serial_v  = calc_stage_r[i].csr_v & ~exc_stage_n[i+1].poison_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 545:       end</pre>
<pre style="margin:0; padding:0 "> 546: </pre>
<pre style="margin:0; padding:0 "> 547:     // Additional commit point information</pre>
<pre style="margin:0; padding:0 "> 548:     calc_status.mem3_pc     = calc_stage_r[2].pc;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 549:     calc_status.mem3_miss_v = pipe_mem_miss_v_lo & ~exc_stage_r[2].poison_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 550:     calc_status.mem3_cmt_v  = calc_stage_r[2].v & ~exc_stage_r[2].roll_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 551:     </pre>
<pre style="margin:0; padding:0 "> 552:     // Slicing the completion pipe for Forwarding information</pre>
<pre style="margin:0; padding:0 "> 553:     for (integer i = 1; i < pipe_stage_els_lp; i++) </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 554:       begin : comp_stage_slice</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 555:         comp_stage_n_slice_iwb_v[i]   = calc_stage_r[i-1].irf_w_v & ~exc_stage_n[i].poison_v; </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 556:         comp_stage_n_slice_fwb_v[i]   = calc_stage_r[i-1].frf_w_v & ~exc_stage_n[i].poison_v; </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 557:         comp_stage_n_slice_rd_addr[i] = calc_stage_r[i-1].instr.fields.rtype.rd_addr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 558: </pre>
<pre style="margin:0; padding:0 "> 559:         comp_stage_n_slice_rd[i]      = comp_stage_n[i];</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 560:       end</pre>
<pre style="margin:0; padding:0 "> 561:   end</pre>
<pre style="margin:0; padding:0 "> 562: </pre>
<pre style="margin:0; padding:0 "> 563: always_comb </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 564:   begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 565:     // Exception aggregation</pre>
<pre style="margin:0; padding:0 "> 566:     for (integer i = 0; i < pipe_stage_els_lp; i++) </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 567:       begin : exc_stage</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 568:         // Normally, shift down in the pipe</pre>
<pre style="margin:0; padding:0 "> 569:         exc_stage_n[i] = (i == 0) ? '0 : exc_stage_r[i-1];</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 570:       end</pre>
<pre style="margin:0; padding:0 "> 571:         // If there are new exceptions, add them to the list</pre>
<pre style="margin:0; padding:0 "> 572:         exc_stage_n[0].fe_nop_v        = fe_nop_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 573:         exc_stage_n[0].be_nop_v        = be_nop_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 574:         exc_stage_n[0].me_nop_v        = me_nop_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 575: </pre>
<pre style="margin:0; padding:0 "> 576:         exc_stage_n[0].roll_v          =                           chk_roll_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 577:         exc_stage_n[1].roll_v          = exc_stage_r[0].roll_v   | chk_roll_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 578:         exc_stage_n[2].roll_v          = exc_stage_r[1].roll_v   | chk_roll_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 579:         exc_stage_n[3].roll_v          = exc_stage_r[2].roll_v   | chk_roll_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 580: </pre>
<pre style="margin:0; padding:0 "> 581:         exc_stage_n[0].poison_v        = chk_poison_iss_r        | chk_poison_isd_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 582:         exc_stage_n[1].poison_v        = exc_stage_r[0].poison_v | chk_poison_ex1_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 583:         exc_stage_n[2].poison_v        = exc_stage_r[1].poison_v | chk_poison_ex2_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 584:         exc_stage_n[3].poison_v        = exc_stage_r[2].poison_v | pipe_mem_miss_v_lo | pipe_mem_exc_v_lo;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 585:   end</pre>
<pre style="margin:0; padding:0 "> 586: </pre>
<pre style="margin:0; padding:0 "> 587: assign instret_mem3_o = calc_stage_r[2].instr_v & ~exc_stage_n[3].poison_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 588: assign pc_mem3_o      = calc_stage_r[2].pc;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 589: assign pc_v_mem3_o    = calc_stage_r[2].v & ~exc_stage_r[2].poison_v;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 590: assign instr_mem3_o   = calc_stage_r[2].instr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 591: </pre>
<pre style="margin:0; padding:0 "> 592: endmodule</pre>
<pre style="margin:0; padding:0 "> 593: </pre>
<pre style="margin:0; padding:0 "> 594: </pre>
</body>
</html>
